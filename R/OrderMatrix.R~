OrderMatrix <-function(matrix, scores=1, output.scores=FALSE){
	require(vegan)
	matrix=(matrix>0)+0
#reciprocal averaging
	temp=decorana(matrix,ira=1)

#ordering of matrix
	if(output.scores==FALSE){
	ret=matrix[order(temp$rproj[,scores], decreasing=FALSE), order(temp$cproj[,scores],decreasing=FALSE)]
	ret=as.matrix(ret)	
  ret=apply(ret,2,rev)
	return(ret)}

	if(output.scores==TRUE){
		return(list(species.scores=colweights=temp$cproj[,scores], site.scores=temp$rproj[,scores]))}
}
